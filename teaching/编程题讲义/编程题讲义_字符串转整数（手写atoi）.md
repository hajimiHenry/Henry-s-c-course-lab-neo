# 编程题讲义：字符串转整数（手写 `atoi`）

> 目标：理解“把字符数字累积成整数”的本质，能处理空白、符号、非法字符，并避免溢出。

## 1. 核心公式：从左到右累积
假设当前结果是 `value`，读到一个数字字符 `ch`（'0'..'9'），对应数值 `d = ch - '0'`，更新：
```
value = value * 10 + d
```
这就是十进制“进位”的过程。

## 2. 推荐处理流程（分阶段）
1) 跳过前导空白（空格、制表、换行等）
2) 处理可选符号 `+`/`-`
3) 循环读数字并累积
4) 遇到非数字结束（题目若要求报错/输出 0，要按规则来）

示例模板：
```c
long long to_int(const char *s)
{
    long long value = 0;
    int sign = 1;

    while (*s == ' ' || *s == '\t' || *s == '\n') s++;
    if (*s == '-') { sign = -1; s++; }
    else if (*s == '+') { s++; }

    while (*s >= '0' && *s <= '9') {
        value = value * 10 + (*s - '0');
        s++;
    }
    return sign * value;
}
```

## 3. 溢出处理（看题目要求）
如果题目范围可能超过 `int`，建议用 `long long`。
若题目要求在溢出时截断/报错，需要额外判断：
- 在乘 10 前判断 `value` 是否会超过上限

## 4. 自检清单
- 符号是否只处理一次？（`--123` 这类按题目规则处理）
- 遇到第一个非数字是否及时停止？
- 输入是空串/全空白时返回什么？是否符合要求？
- 是否需要处理前导 0？

